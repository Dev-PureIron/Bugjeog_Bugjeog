<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>유통업체 PR 사이트</title>
    <link rel="stylesheet" as="style" crossorigin
          href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.6/dist/web/variable/pretendardvariable.css"/>
    <link rel="stylesheet" href="/css/boardList/pr-boardList.css">
    <link rel="stylesheet" href="/css/board_detail/board_detail.css">
    <link rel="stylesheet" href="/css/main/header.css">
</head>
<body>
<div th:insert="~{main/header :: header}"></div>
<div class="all-wrap">
    <div id="header"></div>
    <div class="header-padding"></div>
    <div>
        <header class="boardList-header">
            <section class="banner-box"></section>
        </header>
    </div>
    <div class="boardList-section">
        <h2 class="boardList-title">다양한 유통업체들을 만나보세요!</h2>
        <div class="edge-div"></div>
        <div class="select-button-box">
            <div class="select-button-box-layout">
                <div class="cate-button-box">
                    <div class="cate-button-box-layout">
                        <button type="button" class="cate-button cate-button-active">
                            <span>전체</span>
                        </button>
                        <button type="button" class="cate-button">
                            <span>육류</span>
                        </button>
                        <button type="button" class="cate-button">
                            <span>해산물</span>
                        </button>
                        <button type="button" class="cate-button">
                            <span>채소</span>
                        </button>
                        <button type="button" class="cate-button">
                            <span>향신료</span>
                        </button>
                    </div>
                </div>
                <hr>
                <div class="recent-popluar-box">
                    <div class="recent-popluar-box-layout">
                        <div class="recent-box">
                            <button type="button" class="recent-button sort-button sort-button-active">
                                <span>최신순</span>
                            </button>
                        </div>
                        <div class="popluar-box">
                            <button type="button" class="popluar-button sort-button">
                                <span>인기순</span>
                            </button>
                        </div>
                    </div>
                    <div>
                        <button class="pr-register-button">
                            <a href="/board/business/write">
                                등록하기
                            </a>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <ul class="boardList-info-box">
        </ul>
    </div>
    <button type="button" class="scroll-top-button">
        <img src="/image/boardList/arrow_icon.png" class="top-button">
    </button>
    <div class="modal-active">
        <div id="modal_wrap">
            <div id="dimmer"></div>
            <div id="event_detail_modal">
                <button class="event_detail_modal_btn">
                        <span style="display: flex;">
                            <svg class="event_detail_modal_svg" viewBox="0 0 24 24">
                                <path d="M17.97 19.03a.749.749 0 1 0 1.06-1.06l-6.5-6.5a.749.749 0 0 0-1.06 0l-6.5 6.5a.749.749 0 1 0 1.06 1.06L12 13.06l5.97 5.97zM12 10.94 6.03 4.97a.749.749 0 1 0-1.06 1.06l6.5 6.5a.749.749 0 0 0 1.06 0l6.5-6.5a.749.749 0 1 0-1.06-1.06L12 10.94z"></path>
                            </svg>
                        </span>
                </button>
            </div>
            <div id="all_wrap">
            </div>
        </div>
    </div>
</div>
</body>
<script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>

<script th:inline="javascript">
    $(document).ready(function () {
        // 등록 버튼 초기 색상 설정
        $('button[type="submit"]').css("color", "rgb(196, 196, 196)").css("background-color", "rgb(242, 244, 247)");

        // textarea 입력시 등록 버튼 색상 변경
        $('#reply_textarea').on('input', function () {
            if ($(this).val().length > 0) {
                $('button[type="submit"]').css("color", "white").css("background-color", "blue");
            } else {
                $('button[type="submit"]').css("color", "rgb(196, 196, 196)").css("background-color", "rgb(242, 244, 247)");
            }
        });
    });
    const $ul = $($('ul.boardList-info-box')[0]);
    //      모달 키고 끄는 js
    const $modal = $(".modal-active");
    const $modalBtn = $(".modal_button");
    const $closeBtn = $(".event_detail_modal_btn");
    const body = document.getElementsByTagName('body')[0];

</script>
<script th:inline="javascript" src="/js/boardDetail/boardBusinessDetailFunction.js"></script>
<script th:inline="javascript">
    let boards = [[${boards}]];
    showList(boards);
</script>
<script src="/js/boardList/pr-boardList.js"></script>

<script th:inline="javascript">

    const $labels = $('label.modal_button');
    $labels.on("click", (e) => {
        let $label = $(e.currentTarget);
        alert($label.attr("name"));
        $modal.fadeIn(200);
        body.classList.add('scrollLock');
        $(".scroll-top-button").css("display", "none");
        detailAjax($label.attr("name"));
    });

    // $modalBtn.each((i, e) => {
    //     $(e).click(function () {
    //
    //     });
    // });

    function detailAjax(boardBusinessId) {
        $.ajax({
            url: "/board/business/detail",
            method: "post",
            data: JSON.stringify(boardBusinessId),
            contentType: "application/json; charset=utf-8",
            success: function (result) {
                alert("디테일 성공");
                let dataResult = JSON.parse(result);

                let board =     JSON.parse(dataResult.board);
                let reviews =   JSON.parse(dataResult.reviews);
                let boards =    JSON.parse(dataResult.boards);
                let member =    JSON.parse(dataResult.member);
                let boardImgs = JSON.parse(dataResult.boardImgs);

                showDetail(board, reviews, boards, member, boardImgs);
                // console.log(dataResult);
                // console.log(result.member);
                // console.log(dataResult.member);
                // let data = JSON.parse(result);
                // let dataMember = data.member;
                // console.log(dataMember);

                // alert(result);
                // let resultObject = JSON.parse(JSON.stringify(result));
                // console.log(result.member.memberId);
                // let test = JSON.parse(result);
                // let reviews = test.reviews;
                // let boards = test.boardList;
                // let member = test.member;
                // let boardImgs = test.boardImgs;
                // let memberImgFullPath = result.memberImgFullPath;
                // console.log(board);
                afterDetail();

            },
            error: function (e) {
                alert("전송실패 " + e);
            }
        });
    }

    $closeBtn.each((i, e) => {
        $(e).click(function () {
            $(".scroll-top-button").show();
            $modal.fadeOut(200);
            body.classList.remove('scrollLock');
        });
    });

    // 즐겨찾기 버튼
    const $bookMarks = $(".book-mark");

    $bookMarks.each((i, bookMark) => {
        $(bookMark).on("click", function () {
            if ($(this).attr("fill") == "rgb(51, 102, 255)") {
                $(this).attr("fill", "black");
            } else {
                $(this).attr("fill", "rgb(51, 102, 255)");
            }
        });
    });


</script>
<script src="/js/boardDetail/pr-boardList-test.js"></script>
<script th:inline="javascript">


    /* 작성글 목록 */
    // const boards = JSON.parse($boards); /* boards 정의해야 함 */


    // /* 카테고리 버튼 이벤트 */
    // const $cateButton = $(".cate-button");
    //
    // $cateButton.each((i, e) => {
    //
    //     $(e).click(function () {
    //         $cateButton.removeClass("cate-button-active");
    //         $(e).addClass("cate-button-active");
    //         ajax();
    //     });
    // });
    //
    // function ajax() {
    //     const categoryName = $($(".cate-button.cate-button-active")[0]).attr('name');
    //     const sortType = $($(".sort-button.sort-button-active")[0]).attr('name');
    //     console.log(sortType);
    //     $.ajax({
    //         url: "/board/business/list",
    //         method: "POST",
    //         data: {
    //             category: categoryName
    //             , sort: sortType
    //         },
    //         dataType: "json",
    //         success: function (result) {
    //             let newBoards = `${result}`;
    //             $ul.empty();
    //             showList(result);
    //         },
    //         error: function (e) {
    //             console.log(e);
    //         }
    //     });
    // }
    //
    // /* sort 버튼 이벤트 */
    // const $sortButton = $(".sort-button");
    //
    // $sortButton.each((i, e) => {
    //     $(e).click(function () {
    //         $sortButton.removeClass("sort-button-active");
    //         $(e).addClass("sort-button-active");
    //         ajax();
    //     });
    // });
</script>
</html>